

library(caret); library(kernlab); data(spam)

str(spam)



#1. Data splitting : Train 75% , Test 25%
inTrain <- createDataPartition(y=spam$type, p=0.75, list=FALSE)

training = spam[inTrain,]
testing = spam[-inTrain,]

dim(training)


#2. Fit a Model
set.seed(123)
modelFit = train(type ~., data=training, method="glm")
modelFit # shows Accuracy, Kappa


#3. Final Model
modelFit$finalModel
predictions = predict(modelFit, newdata=testing)

confusionMatrix(predictions, testing$type)

# confusion matrix function wraps a bunch of different accuracy measures 
# that you might want to get out when you're evaluating the model fit.
